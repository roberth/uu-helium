-- first version: Rijk-Jan van Haaften, August 22, 2002
--
-- Every non-terminal now has:
--   1) a local attribute "range" to construct its corresponding range
--   2) a synthesized attribute "range"   (copy-rule) 
--
-- Note: Since there is no synthesized attribute defined for "Module", 
--       including this file does not change the type of
--       sem_Module!

-- ------------------------------------------------------------------------
-- -- Modules                                                            --
-- ------------------------------------------------------------------------

ATTR Expression Pattern Alternative Declaration
     Statement FunctionBinding LeftHandSide RightHandSide
     Qualifier GuardedExpression ImportSpecification
     RecordExpressionBinding RecordPatternBinding
     Type AnnotatedType Constructor Name
     FieldDeclaration ContextItem Literal Body
     [ | | thisRange : Range ]

ATTR Alternatives AnnotatedTypes Constructors ContextItems Declarations
     Expressions FieldDeclarations FunctionBindings GuardedExpressions
     Patterns Qualifiers RecordExpressionBindings RecordPatternBindings
     Statements Types Exports Names
     [ | | thisRange USE { : } { [] }: { [Range] } ]

ATTR MaybeExports MaybeDeclarations MaybeNames
     [ | | thisRange : { Maybe [Range] } ]
ATTR MaybeImportSpecification MaybeExpression MaybeName
     [ | | thisRange : { Maybe Range } ]

SEM Module
    | Module   loc . thisRange = @range.self

SEM MaybeExports
    | Nothing   loc . thisRange = Nothing
    | Just      loc . thisRange = Just @exports.thisRange

SEM Export
    | Variable              loc . thisRange = @range.self
    | TypeOrClass           loc . thisRange = @range.self
    | TypeOrClassComplete   loc . thisRange = @range.self
    | Module                loc . thisRange = @range.self

SEM Body
    | Body   loc . thisRange = @range.self

SEM ImportDeclaration
    | Import   loc . thisRange = @range.self
    | Empty    loc . thisRange = @range.self

SEM MaybeImportSpecification
    | Nothing   loc . thisRange = Nothing
    | Just      loc . thisRange = Just @importspecification.thisRange

SEM ImportSpecification
    | Import   loc . thisRange = @range.self

SEM Import
    | Variable              loc . thisRange = @range.self
    | TypeOrClass           loc . thisRange = @range.self
    | TypeOrClassComplete   loc . thisRange = @range.self

-- ------------------------------------------------------------------------
-- -- Declarations                                                       --
-- ------------------------------------------------------------------------

SEM MaybeDeclarations
    | Nothing    loc . thisRange = Nothing
    | Just       loc . thisRange = Just @declarations.thisRange

SEM Declaration
    | Type               loc . thisRange = @range.self
    | Data               loc . thisRange = @range.self
    | Newtype            loc . thisRange = @range.self
    | Class              loc . thisRange = @range.self
    | Instance           loc . thisRange = @range.self
    | Default            loc . thisRange = @range.self
    | FunctionBindings   loc . thisRange = @range.self
    | PatternBinding     loc . thisRange = @range.self
    | TypeSignature      loc . thisRange = @range.self
    | Fixity             loc . thisRange = @range.self
    | Empty              loc . thisRange = @range.self

SEM Fixity
    | Infixl    loc . thisRange = @range.self
    | Infixr    loc . thisRange = @range.self
    | Infix     loc . thisRange = @range.self

-- ------------------------------------------------------------------------
-- -- Types                                                              --
-- ------------------------------------------------------------------------

SEM Type
    | Application     loc . thisRange = @range.self
    | Variable        loc . thisRange = @range.self
    | Constructor     loc . thisRange = @range.self
    | Qualified       loc . thisRange = @range.self
    | Forall          loc . thisRange = @range.self
    | Exists          loc . thisRange = @range.self
    | Parenthesized   loc . thisRange = @range.self

SEM SimpleType
    | SimpleType   loc . thisRange = @range.self

  
SEM ContextItem
    | ContextItem   loc . thisRange = @range.self

SEM Constructor
    | Constructor    loc . thisRange = @range.self
    | Infix          loc . thisRange = @range.self
    | Record         loc . thisRange = @range.self

SEM FieldDeclaration
    | FieldDeclaration   loc . thisRange = @range.self

SEM AnnotatedType
    | AnnotatedType   loc . thisRange = @range.self

-- ------------------------------------------------------------------------
-- -- Expressions                                                        --
-- ------------------------------------------------------------------------

SEM MaybeExpression
    | Nothing     loc . thisRange = Nothing
    | Just        loc . thisRange = Just @expression.thisRange

SEM Expression
    | Literal             loc . thisRange = @range.self
    | Variable            loc . thisRange = @range.self
    | Constructor         loc . thisRange = @range.self
    | Parenthesized       loc . thisRange = @range.self
    | NormalApplication   loc . thisRange = @range.self
    | InfixApplication    loc . thisRange = @range.self
    | If                  loc . thisRange = @range.self
    | Lambda              loc . thisRange = @range.self
    | Case                loc . thisRange = @range.self
    | Let                 loc . thisRange = @range.self
    | Do                  loc . thisRange = @range.self
    | List                loc . thisRange = @range.self
    | Tuple               loc . thisRange = @range.self
    | Comprehension       loc . thisRange = @range.self
    | Typed               loc . thisRange = @range.self
    | RecordConstruction  loc . thisRange = @range.self
    | RecordUpdate        loc . thisRange = @range.self
    | Enum                loc . thisRange = @range.self
    | Negate              loc . thisRange = @range.self

SEM Statement
    | Expression  loc . thisRange = @range.self
    | Let         loc . thisRange = @range.self
    | Generator   loc . thisRange = @range.self
    | Empty       loc . thisRange = @range.self

SEM Qualifier
    | Guard       loc . thisRange = @range.self
    | Let         loc . thisRange = @range.self
    | Generator   loc . thisRange = @range.self
    | Empty       loc . thisRange = @range.self

SEM Alternative
    | Alternative    loc . thisRange = @range.self
    | Empty          loc . thisRange = @range.self

SEM GuardedExpression
    | GuardedExpression   loc . thisRange = @range.self

SEM RecordExpressionBinding
    | RecordExpressionBinding   loc . thisRange = @range.self

SEM RecordPatternBinding
    | RecordPatternBinding   loc . thisRange = @range.self

SEM FunctionBinding
    | FunctionBinding   loc . thisRange = @range.self

SEM LeftHandSide
    | Function       loc . thisRange = @range.self
    | Infix          loc . thisRange = @range.self
    | Parenthesized  loc . thisRange = @range.self

SEM RightHandSide
    | Expression  loc . thisRange = @range.self
    | Guarded     loc . thisRange = @range.self

-- ------------------------------------------------------------------------
-- -- Patterns                                                           --
-- ------------------------------------------------------------------------

SEM Pattern
    | Literal            loc . thisRange = @range.self
    | Variable           loc . thisRange = @range.self
    | Constructor        loc . thisRange = @range.self
    | Parenthesized      loc . thisRange = @range.self
    | InfixConstructor   loc . thisRange = @range.self
    | List               loc . thisRange = @range.self
    | Tuple              loc . thisRange = @range.self
    | Record             loc . thisRange = @range.self
    | Negate             loc . thisRange = @range.self
    | As                 loc . thisRange = @range.self
    | Wildcard           loc . thisRange = @range.self
    | Irrefutable        loc . thisRange = @range.self
    | Successor          loc . thisRange = @range.self

-- ------------------------------------------------------------------------
-- -- Basics                                                             --
-- ------------------------------------------------------------------------

SEM Literal
    | Int         loc . thisRange = @range.self
    | Char        loc . thisRange = @range.self
    | Float       loc . thisRange = @range.self
    | String      loc . thisRange = @range.self

SEM MaybeNames
    | Nothing     loc . thisRange = Nothing
    | Just        loc . thisRange = Just @names.thisRange

SEM MaybeName
    | Nothing     loc . thisRange = Nothing
    | Just        loc . thisRange = Just @name.thisRange

SEM Name
    | Identifier  loc . thisRange = @range.self
    | Operator    loc . thisRange = @range.self
    | Special     loc . thisRange = @range.self

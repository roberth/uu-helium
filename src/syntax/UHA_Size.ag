-- a simple estimation of the size of an abstract syntax tree in the UHA-format

ATTR Pattern Expression Statement Qualifier Alternative Declaration FunctionBinding RightHandSide 
     GuardedExpression LeftHandSide Body [ | | size:Int ]

ATTR Patterns Expressions Statements Qualifiers Alternatives Declarations FunctionBindings 
     MaybeExpression MaybeDeclarations GuardedExpressions [ | | size USE { + } { 0 } : Int ]

SEM Pattern
  | Literal           loc . size = 1
  | Variable          loc . size = 1 
  | Constructor       loc . size = 1 + @patterns.size   
  | InfixConstructor  loc . size = 1 + @leftPattern.size + @rightPattern.size
  | Record            loc . size = undefined
  | Negate            loc . size = 1
  | NegateFloat       loc . size = 1
  | As                loc . size = 1 + @pattern.size
  | Wildcard          loc . size = 1
  | Successor         loc . size = 1

SEM Expression    
  | Literal           loc . size = 1
  | Variable          loc . size = 1
  | Constructor       loc . size = 1
  | NormalApplication loc . size = 1 + @function.size + @arguments.size
  | InfixApplication  loc . size = 1 + @leftExpression.size + @rightExpression.size
  | If                loc . size = 1 + @guardExpression.size + @thenExpression.size + @elseExpression.size
  | Lambda            loc . size = 1 + @patterns.size + @expression.size
  | Case              loc . size = 1 + @expression.size + @alternatives.size
  | Let               loc . size = 1 + @declarations.size + @expression.size
  | Do                loc . size = 1 + @statements.size
  | List              loc . size = 1 + @expressions.size
  | Tuple             loc . size = 1 + @expressions.size
  | Comprehension     loc . size = 1 + @expression.size + @qualifiers.size
  | Typed             loc . size = 1 + @expression.size
  | RecordConstruction loc. size = undefined
  | RecordUpdate       loc. size = undefined
  | Enum              loc . size = 1 + @from.size + @then.size + @to.size
  | Negate            loc . size = 1 + @expression.size
  | NegateFloat       loc . size = 1 + @expression.size

SEM Statement
  | Generator         loc . size = @pattern.size + @expression.size
  | Empty             loc . size = 0

SEM Qualifier
  | Generator         loc . size = @pattern.size + @expression.size
  | Empty             loc . size = 0
 
SEM Alternative
  | Alternative       loc . size = @pattern.size + @righthandside.size
  | Empty             loc . size = 0
 
SEM Declaration 
  | PatternBinding    loc . size = @pattern.size + @righthandside.size
  | Type              loc . size = 0
  | Data              loc . size = 0        
  | Newtype           loc . size = 0
  | Class             loc . size = 0
  | Instance          loc . size = 0
  | Default           loc . size = 0
  | TypeSignature     loc . size = 0
  | Fixity            loc . size = 0
  | Empty             loc . size = 0
 
SEM FunctionBinding
  | FunctionBinding   loc . size = @lefthandside.size + @righthandside.size

SEM RightHandSide
  | Expression        loc . size = @expression.size + @where.size
  | Guarded           loc . size = @guardedexpressions.size + @where.size
 
SEM GuardedExpression 
  | GuardedExpression loc . size = @guard.size + @expression.size
 
SEM LeftHandSide
  | Infix             loc . size = 1 + @leftPattern.size + @rightPattern.size
  | Parenthesized     loc . size = @lefthandside.size + @patterns.size
